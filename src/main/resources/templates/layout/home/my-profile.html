<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rent a Car</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
    <link href='https://unpkg.com/boxicons@2.1.1/css/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
          integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A=="
          crossorigin="anonymous" referrerpolicy="no-referrer"/>
    <link rel="stylesheet" th:href="@{css/header.css}">

    <style>
        .content .content-header {
            margin-left: 50px;
            margin-top: 25px;
        }

        .content .content-header span {
            margin-left: 10px;
            margin-right: 10px;
        }

        .content .content-header a {
            color: black;
        }

        .content .content-header a:hover {
            text-decoration: none;
            color: #007bff;
        }

        .content .content-body h2 {
            margin: 25px 0 25px 50px;
        }

        .content .content-body section {
            margin-left: 30px;
            margin-bottom: 25px;
        }

        .content .content-body section ul li a {
            color: black;
        }

        .content .content-body section ul li a span {
            margin-left: 15px;
            margin-right: 15px;
        }

        .content .content-body section form .row {
            margin-bottom: 20px;
        }

        .content .content-body section form .row input[type="file"] {
            border: 1px solid #ccc;
            padding: 3px;
            border-radius: 4px;
        }

        .content .content-body section .row button {
            width: 100px;
        }
    </style>
</head>
<body>
<input type="hidden" name="city" th:value="${city}">
<input type="hidden" name="district" th:value="${district}">
<input type="hidden" name="ward" th:value="${ward}">
<!-- Include Header Fragment -->
<div th:replace="fragments/fragment :: header"></div>

<div class="content">
    <div class="content-header">
        <a th:href="@{/home-page}">Home</a>
        <span> > </span>
        <a th:href="@{/my-profile}">My Profile</a>
    </div>

    <div class="content-body">
        <h2>My Profile</h2>
        <section class="container">
            <ul class="nav nav-tabs" role="tablist">
                <li class="nav-item">
                    <a class="nav-link active" id="personal-info-tab" data-toggle="tab" href="#personal-info" role="tab"
                       aria-controls="personal-info" aria-selected="true"><span>Personal Information</span></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="security-tab" data-toggle="tab" href="#security" role="tab"
                       aria-controls="security" aria-selected="false"><span>Security</span></a>
                </li>
            </ul>
            <div class="tab-content p-3 border border-top-0" id="carDetailsTabContent">
                <div class="tab-pane fade show active" id="personal-info" role="tabpanel"
                     aria-labelledby="personal-info-tab">
                    <div class="container">
                        <div class="row">
                            <div class="col">
                                <form th:action="@{/updateProfile}" method="post" enctype="multipart/form-data">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <label for="driverName">Full Name: <span
                                                    class="text-danger">*</span></label>
                                            <input type="text" class="form-control" id="driverName" name="name"
                                                   placeholder="Full Name" th:value="${profile.name}">
                                        </div>
                                        <div class="col-md-6">
                                            <label for="driverDob">Date of birth: <span
                                                    class="text-danger">*</span></label>
                                            <input type="date" class="form-control" id="driverDob" name="dateOfBirth"
                                                   placeholder="dd/mm/yyyy" th:value="${profile.dateOfBirth}">
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <label for="driverPhone">Phone number: <span
                                                    class="text-danger">*</span></label>
                                            <input type="text" class="form-control" id="driverPhone" name="phoneNo"
                                                   placeholder="Phone number" th:value="${profile.phoneNo}">
                                        </div>
                                        <div class="col-md-6">
                                            <label for="driverEmail">Email address: <span
                                                    class="text-danger">*</span></label>
                                            <input type="email" class="form-control" id="driverEmail" name="email"
                                                   placeholder="Email address" th:value="${profile.email}">
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <label for="driverId">National ID No.: <span
                                                    class="text-danger">*</span></label>
                                            <input type="text" class="form-control" id="driverId" name="nationalIdNo"
                                                   placeholder="National ID No." th:value="${profile.nationalIdNo}">
                                        </div>
                                        <div class="col-md-6">
                                            <label for="driverLicense">Driving license:</label>
                                            <input type="file" class="form-control-file" id="driverLicense"
                                                   name="drivingLicense" th:value="${profile.drivingLicense}">
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-8">
                                            <select id="citySelect" name="city" class="form-control mb-2">
                                                <option value="">Select City/Province</option>
                                            </select>
                                            <select id="districtSelect" name="district" class="form-control mb-2"
                                                    disabled>
                                                <option value="">Select District</option>
                                            </select>
                                            <select id="wardSelect" name="ward" class="form-control mb-2" disabled>
                                                <option value="">Select Ward</option>
                                            </select>
                                            <input type="text" id="houseNumber" name="houseNumber"
                                                   class="form-control mb-2" placeholder="House number"
                                                   th:value="${houseNumber}">
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-12 text-center" style="margin-top: 20px">
                                            <button type="button" class="btn btn-secondary"><span>Discard</span>
                                            </button>
                                            <button type="submit" class="btn btn-primary"><span>Save</span></button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tab-pane fade" id="security" role="tabpanel" aria-labelledby="security-tab">
                    <div class="container">
                        <div class="row">
                            <div class="col">
                                <form th:action="@{/changePassword}" method="post">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <label for="newPassword">New Password: <span
                                                    class="text-danger">*</span></label>
                                            <input type="password" class="form-control" id="newPassword"
                                                   name="newPassword"
                                                   placeholder="New Password">
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <label for="confirmPassword">Confirm Password: <span
                                                    class="text-danger">*</span></label>
                                            <input type="password" class="form-control" id="confirmPassword"
                                                   name="confirmPassword"
                                                   placeholder="Confirm Password">
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-12 text-left" style="margin-top: 20px">
                                            <button type="button" class="btn btn-secondary"><span>Discard</span>
                                            </button>
                                            <button type="submit" class="btn btn-primary"><span>Save</span></button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>
</div>

<!-- Include Footer Fragment -->
<div th:replace="fragments/fragment :: footer"></div>

<script>
    document.getElementById('user-menu-toggle').onclick = function () {
        var menu = document.getElementById('mega-menu')
        menu.classList.toggle('hidden');
    }

    window.onclick = function (event) {
        if (!event.target.matches('#user-menu-toggle, #user-menu-toggle *')) {
            var menu = document.getElementById('mega-menu');
            if (!menu.classList.contains('hidden')) {
                menu.classList.add('hidden');
            }
        }
    }
</script>

<script>
    function updateCity(selectDom) {
        let textToFind = document.querySelector('input[name=city]').value;
        var dd = selectDom;
        for (var i = 0; i < dd.options.length; i++) {
            if (dd.options[i].text === textToFind) {
                dd.selectedIndex = i;
                break;
            }
        }
        const event = new Event('change');
        selectDom.dispatchEvent(event);
    }

    function updateDistrict(selectDom) {
        let textToFind = document.querySelector('input[name=district]').value;
        var dd = selectDom;
        for (var i = 0; i < dd.options.length; i++) {
            if (dd.options[i].text === textToFind) {
                dd.selectedIndex = i;
                break;
            }
        }
        const event = new Event('change');
        selectDom.dispatchEvent(event);
    }

    function updateWard(selectDom) {
        let textToFind = document.querySelector('input[name=ward]').value;
        var dd = selectDom;
        for (var i = 0; i < dd.options.length; i++) {
            if (dd.options[i].text === textToFind) {
                dd.selectedIndex = i;
                break;
            }
        }
        const event = new Event('change');
        selectDom.dispatchEvent(event);
    }

    document.addEventListener('DOMContentLoaded', function () {
        const locationData = {
            "Ha Noi": ["Ba Dinh", "Hoan Kiem", "Tay Ho", "Cau Giay", "Dong Da"],
            "Ho Chi Minh": ["District 1", "District 2", "District 3", "Binh Thanh", "Go Vap"],
            "Da Nang": ["Hai Chau", "Thanh Khe", "Lien Chieu", "Ngu Hanh Son", "Son Tra"]
        };

        const citySelect = document.getElementById('citySelect');
        const districtSelect = document.getElementById('districtSelect');
        const wardSelect = document.getElementById('wardSelect');

        for (let city in locationData) {
            let option = document.createElement('option');
            option.value = city;
            option.textContent = city;
            citySelect.appendChild(option);
        }

        districtSelect.value = "${district}";
        wardSelect.value = "${ward}";

        citySelect.addEventListener('change', function () {
            let selectedCity = this.value;
            districtSelect.innerHTML = '<option value="">Select District</option>';

            if (selectedCity && locationData[selectedCity]) {
                locationData[selectedCity].forEach(district => {
                    let option = document.createElement('option');
                    option.value = district;
                    option.textContent = district;
                    districtSelect.appendChild(option);
                });
                districtSelect.disabled = false;
            } else {
                districtSelect.disabled = true;
            }
            wardSelect.disabled = true;
            wardSelect.innerHTML = '<option value="">Select Ward</option>';
        });

        updateCity(citySelect);

        districtSelect.addEventListener('change', function () {
            let selectedDistrict = this.value;
            wardSelect.innerHTML = '<option value="">Select Ward</option>';

            if (selectedDistrict) {
                let wards = ["Ward 1", "Ward 2", "Ward 3"];
                wards.forEach(ward => {
                    let option = document.createElement('option');
                    option.value = ward;
                    option.textContent = ward;
                    wardSelect.appendChild(option);
                });
                wardSelect.disabled = false;
            } else {
                wardSelect.disabled = true;
            }
        });
        updateDistrict(districtSelect);
        updateWard(wardSelect);
    });
</script>
<script>
    const optionMenu = document.querySelector(".select-menu"),
        selectBtn = optionMenu.querySelector(".select-btn"),
        options = optionMenu.querySelectorAll(".option"),
        sBtn_text = optionMenu.querySelector(".sBtn-text");

    selectBtn.addEventListener("click", () => optionMenu.classList.toggle("active"));

    options.forEach(option => {
        option.addEventListener("click", () => {
            sBtn_text.innerText = option.querySelector(".option-text").innerText;

            let value = option.getAttribute("data-value");
            if (value) {
                location.href = value;
            }

            optionMenu.classList.remove("active");
        });
    });
</script>
<script>
    const optionElements = document.querySelectorAll(".option");

    optionElements.forEach(option => {
        option.addEventListener("click", () => {
            let value = option.getAttribute("data-value");
            if (value) {
                location.href = value;
            }
            option.classList.toggle("active");
        });
    });
</script>

</body>
</html>